---
layout: post
title:  "CLIP 임베딩 기반 스타일 분석 프로젝트 1주차"
date:   2025-11-14 00:10:22 +0900
categories: LoRAMap
---

# 들어가며

CivitAI에는 자주 새로운 LoRA 모델이 쏟아지지만,
여전히 LoRA를 “스타일” 기준으로 탐색하기는 쉽지 않다.

기존 검색 방식은 텍스트 기반이며,
비슷한 스타일의 모델을 추천받는 기능은 부족하다.

"LoRA 이미지들의 스타일을 자동으로 분류할 수 없을까?"

이번 개인 프로젝트는 이렇게 시작되었다.  

시작은 분류 모델을 목표로 했지만, 이 문제에 분류가 적합하지 않음을 깨닫기까지는 얼마 걸리지 않았다.  

결과적으로는 분류에서 군집화라는 방향 전환이 필요했다.

---

# 처음에는 “분류 모델”을 만들려고 했다

처음에는 단순하게 생각했다.  
그 사고 절차는 대략 아래처럼 진행되었다.

1. LoRA 스타일을 사람이 정의한다.
예: anime / realistic / 3d / sketch 등등

2. 그 라벨대로 이미지 데이터를 모은다

3. Vision Transformer나 CNN으로 학습한다

3. 입력 이미지를 “스타일 카테고리”로 예측한다

즉, 지도학습을 목표로 했던 것이다.

그래서 config.py에도 이렇게 라벨 목록을 넣어두었었다.

STYLE_CLASSES = [
    "anime",
    "western-cartoon",
    "realistic",
    "3d-render",
    ...
]

그런데 곧 현실적인 문제가 드러났다.

---

# 큰 문제 1: LoRA 스타일은 명확한 클래스가 아니다

분류 모델이 성립하려면 라벨이 명확해야 한다.
하지만 CivitAI LoRA 스타일은…

하나의 LoRA가 anime + sketch 느낌이 동시에 있을 수 있다.
사진/실사도 모델에 따라 전혀 다른 질감을 가진다.  

여러 LoRA는 서로 비슷한데, 완전히 다른 태그로 올라오기도 한다.  

이는 keyword를 통해 웹 스크래핑을 할 때 문제를 초래한다.
태그 구조가 정형화되어 있지 않아 라벨링이 애초에 불가능한 문제였다.

“anime”라고 다 같은 anime 스타일이 아니다.
진짜로 모아보면 다음과 같이 미세 스타일 차이가 극심하다.

태그로는 이 차이를 정의할 수 없다.
분류 모델의 라벨링 기준 자체가 무너진다.

---

# 큰 문제 2: 라벨 수집 비용이 상상을 초월함

분류를 하려면 사람이 라벨을 달아야 한다.
하지만 LoRA 모델은 수천 개, 이미지 샘플은 만 단위다.

AI 모델을 훈련시키기 위해서
내가 직접 모든 LoRA에 “이 스타일은 ooo이다"라고 라벨링하는 건 사실상 불가능했다.

스타일에는 매우 다양한 스펙트럼이 존재한다.

나는 분류 모델을 만들기 위한 태그 기반 라벨링이
필요 이상으로 좁고 왜곡된 범주를 만들 뿐이라는 걸 알아챘다.

이게 바로 군집화(clustering) 접근의 시작이었다.

---

# 분류에서 군집화로

그렇게 접근법은 군집화로 바뀌게 되었다.  
이를 추구하며 몇 가지 응용 가능성이 떠올랐다.

그중 하나는 프롬프트 텍스트를 입력하면 가장 유사한 스타일의 LoRA 클러스터를 추천하는 시스템이다.

CLIP은 텍스트 임베딩과 이미지 임베딩을 동일한 공간에 두기 때문에 “텍스트 -> 클러스터” 매핑이 가능해진다.

---

# 데이터 수집 -> 이미지 정제 -> 임베딩 생성

군집화로 방향이 정해지자,
그 다음 단계는 데이터를 준비하는 일이었다.

**1** CivitAI REST API로 LoRA 이미지 수집

**2** 손상 이미지 자동 검증

**3** CLIP 임베딩 생성(512D)

이 이후 단계로는
PCA -> UMAP -> KMeans -> centroids를 거쳐
그리고 Streamlit 기반 추천 UI로 이어진다.

---

# 마무리

프로젝트가 알려준 가장 큰 교훈은 이것이다.

“정답 라벨이 없는 문제는 분류 모델보다 군집화가 훨씬 더 강력할 수 있다.”

특히 스타일처럼 스펙트럼이 넓고 애매한 문제는
비지도학습으로 데이터 자체의 구조를 드러내는 것이 해답이다.

결국 LoRA 스타일 분석은
라벨보다 embedding geometry를 이해하는 게임이었다.