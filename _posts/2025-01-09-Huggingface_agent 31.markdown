---
layout: post
title:  "허깅페이스 에이전트 코스 - Agentic Retrieval Augmented Generation (RAG)"
date:   2025-01-9 00:10:22 +0900
categories: Huggingface_agent
---

# Agentic Retrieval Augmented Generation (RAG)

이번 유닛에서는 **Agentic RAG**를 활용하여  
집사 **Alfred**가 갈라(Gala)를 준비하는 과정을 어떻게 지능적으로 지원할 수 있는지 살펴본다.

이 섹션의 초점은 단순한 RAG 개념 복습이 아니라,  
**“에이전트가 스스로 판단하며 RAG를 활용하는 구조”** 를 이해하는 데 있다.

## 왜 RAG가 필요한가?

LLM은 방대한 데이터로 사전 학습되어 **일반적인 지식**에는 강하다.  
그러나 다음과 같은 한계가 존재한다.

- 최신 정보(뉴스, 날씨, 실시간 데이터)를 알 수 없음
- 조직 내부 문서, 개인 데이터에 접근할 수 없음
- 특정 도메인에 특화된 정보가 부족할 수 있음

이를 해결하는 방법이 바로 **Retrieval Augmented Generation (RAG)** 이다.

RAG의 핵심 아이디어는 다음과 같다.

> 질문과 관련된 정보를 **외부 데이터 소스에서 검색(Retrieval)** 한 뒤,  
> 그 결과를 LLM 입력으로 제공하여 **더 정확한 응답을 생성(Generation)** 한다.

## RAG 기본 구조

RAG는 일반적으로 다음 흐름을 따른다.

1. 사용자 질문 입력
2. 질문과 관련된 문서/데이터 검색
3. 검색 결과를 LLM 프롬프트에 포함
4. LLM이 해당 정보를 바탕으로 응답 생성

이 방식은  
LLM의 “기억 한계”를 **외부 지식으로 보완**하는 역할을 한다.

## Alfred의 역할에 RAG를 적용해보면

갈라를 준비하는 Alfred의 상황을 생각해보자.

1. Alfred는 갈라 준비를 도와달라는 요청을 받았다
2. 최신 날씨 정보와 뉴스를 확인해야 한다
3. 초대 손님들의 정보를 구조화하고 검색해야 한다

즉, Alfred는 다음 능력이 필요하다.

- 최신 정보 검색
- 내부 데이터(손님 목록, 일정 등) 조회
- 상황에 맞는 정보 선택 및 응답 생성

이는 전형적인 **RAG 적용 시나리오**다.

## Agentic RAG란 무엇인가?

기존 RAG는 보통 다음과 같이 동작한다.

- 질문 -> 자동 검색 → 자동 응답

반면 **Agentic RAG**는 다르다.

> 에이전트가  
> **“지금 검색이 필요한가?”**,  
> **“어떤 도구를 써야 하는가?”**,  
> **“한 번 더 검색해야 하는가?”**  
> 를 스스로 판단한다.

즉, Agentic RAG에서는:

- RAG는 **도구(tool)** 중 하나일 뿐
- 에이전트가 상황에 따라
  - RAG 사용
  - 웹 검색
  - 날씨 API 호출
  - 다른 로직 실행
  을 선택한다

이로 인해 **검색 -> 판단 -> 행동 -> 재검색**의 반복 구조가 가능해진다.

## RAG vs Agentic RAG 요약


| 구분 | RAG | Agentic RAG |
|---|---|---|
| 검색 시점 | 고정 | 에이전트가 판단 |
| 흐름 | 단일 파이프라인 | 다단계·조건부 |
| 도구 활용 | 제한적 | 자유롭게 조합 |
| 적합한 경우 | 단순 QA | 복잡한 업무 시나리오 |



## Agentic RAG가 필요한 이유 (갈라 시나리오 기준)

Alfred는 다음을 동시에 수행해야 한다.

- 손님 정보 검색
- 최신 날씨 조회
- 일정 및 메뉴 확인
- 필요 시 여러 번 검색
- 질문 유형에 따라 다른 흐름 선택

이는 단순 RAG로는 부족하다.  
**에이전트가 흐름을 제어하는 Agentic RAG**가 필요하다.

## 이번 유닛에서 만들 것

이후 단계에서는 다음을 순차적으로 구축한다.

1. **RAG 도구**
   - 초대 손님 정보 검색
2. **외부 도구**
   - 웹 검색
   - 날씨 정보 조회
   - Hugging Face Hub 모델 다운로드 통계
3. **통합 에이전트**
   - 상황에 따라 적절한 도구를 선택하는 Agentic RAG 에이전트

이를 통해 Alfred는  
**현실적인 업무 환경에서도 활용 가능한 지능형 에이전트**로 완성된다.

## 정리

- RAG는 LLM의 지식 한계를 보완한다
- Agentic RAG는 RAG를 **에이전트의 선택 가능한 행동 중 하나**로 만든다
- 복잡한 실제 업무 시나리오에는 Agentic RAG가 필수적이다

이제 본격적으로  
**Agentic RAG 워크플로우를 구현**할 준비가 되었다.

참고자료
Huggingface, agents course, https://huggingface.co/learn