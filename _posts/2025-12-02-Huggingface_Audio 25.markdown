---
layout: post
title:  "허깅페이스 오디오 트랜스포머 코스 - TTS 모델 평가"
date:   2025-12-02 00:10:22 +0900
categories: Huggingface_Audio
---

# TTS 모델 평가

TTS 모델은 보통 학습할 때
예측한 멜 스펙트로그램과 정답 스펙트로그램의 차이를 줄이는 방향으로 학습한다.

대표적인 loss:

- MSE (Mean Squared Error)
- MAE (Mean Absolute Error)

이 손실은 단순하다.

“각 프레임, 각 주파수(bin)마다 예측값과 정답값의 차이를 최소화하라.”

하지만, **TTS는 원천적으로 “정답이 하나가 아닌 문제(one-to-many)”**다.

같은 텍스트라도

- 말하는 사람에 따라
- 억양에 따라
- 속도에 따라
- 감정에 따라

완전히 다른 스펙트로그램들이 모두 “정답”일 수 있다.

그래서 MSE/MAE를 줄였다고 해서
사람이 들었을 때 더 자연스럽다는 보장은 전혀 없다.

이게 TTS 평가가 까다로운 가장 큰 이유다.

## Loss와 “사람 귀” 사이의 간극

훈련 시 사용하는 loss는 결국 스펙트럼 공간에서의 거리다.
그러나 사람이 듣는 음질은 다음 요소들이 혼합된 결과다.

- 음소가 잘 들리는가? (intelligibility)
- 억양, 리듬, 강세가 자연스러운가? (prosody)
- 목소리가 부자연스럽게 떨리거나 로봇 같지 않은가? (naturalness)
- 화자 고유의 색이 잘 살아 있는가? (speaker similarity)
- 잡음, artifacts, metallic noise가 없는가? (signal artifacts)

MSE/MAE는 이런 것들을 직접적으로 반영하지 못한다.

예시

- 스펙트럼 상으로는 정답과 꽤 유사하지만 말 끝 음절이 자꾸 뭉개지는 모델이 있을 수 있다.
- 반대로, loss는 조금 더 크지만 사람 귀에는 훨씬 더 자연스럽게 들리는 모델도 가능하다.

그래서, TTS 평가에서 훈련 중 loss 곡선의 감소만 보고 품질을 판단하는 것은 위험하다.

## MOS (Mean Opinion Score) - 사실상 표준인 “주관 평가”

### MOS란 무엇인가?

MOS는 사람이 직접 듣고 점수(1~5)를 매기는 방식이다.
설계에 따라 조금씩 다른 변형(예: 1~7, 1~10)이 있지만
논문·산업 모두에서 가장 많이 쓰이는 구조는 1~5점이다.

실제 절차

1. 여러 TTS 시스템(예: baseline vs fine-tuned)을 준비한다.
2. 각 시스템으로 동일한 텍스트 집합을 합성한다.
3. 사람이 헤드폰이나 스피커로 샘플을 듣는다.
4. 샘플당 1~5점의 MOS를 매긴다.
5. 화자별, 문장별 점수들을 평균 내어 시스템 전체 점수를 비교한다.

### MOS의 장점

- 사람 귀 기준이라, 실제 체감 품질과 직접 연결된다.
- 자연스러움, 억양, 감정, 발음 등 복합적인 요소를 통합적으로 평가할 수 있다.
- TTS 논문, 상업 시스템 모두에서 사실상 표준이다.

## MOS의 한계

MOS는 강력하지만 완벽하지 않다.

1. 주관적이다

- 사람마다 기준이 다르다.
- 어떤 사람은 작은 잡음에도 민감.
- 어떤 사람은 억양보다 발음 정확도에 민감.

2. 재현성이 어렵다

- 같은 시스템이라도 실험 참여자가 다르면 MOS가 달라질 수 있다.
- 실험 환경(이어폰, 헤드폰, 볼륨)에 따라 영향.

3. 비용이 크다

- 충분한 통계적 신뢰도를 확보하려면 각 샘플을 여러 명에게 들려줘야 한다.
- 수십~수백 명 단위의 피험자 모집이 필요할 수 있다.

4. 세밀한 요소 분리에는 약하다

- “발음은 좋은데 억양이 부자연스럽다” 같은 구체적인 문제를 단 하나의 MOS 점수로 표현하는 것은 어렵다.

그래서 실제 현업/연구에서는
MOS + 보조 지표들(객관 지표) + 에러 분석
을 함께 사용한다.


참고자료
Huggingface, Audio Course, https://huggingface.co/learn